Logging initialized. Output to D:\GitHub\transition-matrix-equiv\outputs\mnist\run_20260119_211629.log
Running MNIST Experiment with n=200, lambda=0.5...
Training model for 1 epochs...
Epoch 0: Batch 0/938 Loss: 2.3032
Epoch 0: Batch 100/938 Loss: 0.1784
Epoch 0: Batch 200/938 Loss: 0.0317
Epoch 0: Batch 300/938 Loss: 0.0711
Epoch 0: Batch 400/938 Loss: 0.0485
Epoch 0: Batch 500/938 Loss: 0.2038
Epoch 0: Batch 600/938 Loss: 0.0650
Epoch 0: Batch 700/938 Loss: 0.0546
Epoch 0: Batch 800/938 Loss: 0.0205
Epoch 0: Batch 900/938 Loss: 0.1134
Extracting features...
Features shape: A=(200, 490), B=(200, 784)
Estimating generators via rotation...
Generators estimated. J_A: (490, 490), J_B: (784, 784)
Computing Baseline T_old...
Computing Equivariant T_new (Iterative LSQR)...
LSQR Info: 500 iterations, residual: 1.4805e+02

--- Training Evaluation ---
Old: MSE=0.000000, SymDefect=3152763.500000
New: MSE=0.093286, SymDefect=29167.855011

--- Robustness Test (Rotated Test Set) ---
Robustness MSE (30 deg): Old=1.377438, New=0.729035
SSIM: Old=0.1105, New=0.2118
PSNR: Old=8.13, New=10.75
Results saved to D:\GitHub\transition-matrix-equiv\outputs\mnist
